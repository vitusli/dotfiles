{{- $mod := "cmd" -}}
{{- if ne .chezmoi.os "darwin" -}}
{{-   $mod = "ctrl" -}}
{{- end -}}
[
    // Chat
    {
        "key": "{{ $mod }}+i",
        "command": "workbench.action.chat.openagent",
        "when": "!chatSetupDisabled && !chatSetupHidden"
    },
    {
        "key": "{{ $mod }}+l",
        "command": "workbench.action.chat.attachSelection",
        "when": "chatIsEnabled && editorTextFocus"
    },
    {
        "key": "{{ $mod }}+l",
        "command": "workbench.action.terminal.chat.addTerminalSelection",
        "when": "chatIsEnabled && terminalFocus && (terminalHasBeenCreated || terminalProcessSupported)"
    },
    {
        "key": "shift+tab",
        "command": "workbench.action.chat.toggleAgentMode",
        "when": "chatIsEnabled && !chatSessionRequestInProgress"
    },

    // Tasks
    {
        "key": "ctrl+space",
        "command": "workbench.action.tasks.runTask",
        "args": "Slash Search Code"
    },

    // Terminal
{{- if ne .chezmoi.os "darwin" }}
    {
        "key": "ctrl+j",
        "command": "workbench.action.terminal.toggleTerminal"
    },
{{- end }}
    {
        "key": "{{ $mod }}+shift+j",
        "command": "workbench.action.terminal.focus",
        "when": "!terminalFocus"
    },
    {
        "key": "{{ $mod }}+n",
        "command": "workbench.action.terminal.new",
        "when": "terminalFocus"
    },
{{- if eq .chezmoi.os "darwin" }}
    {
        "key": "{{ $mod }}+w",
        "command": "workbench.action.terminal.kill",
        "when": "terminalFocus"
    },
{{- end }}
    {
        "key": "{{ $mod }}+shift+space",
        "command": "runCommands",
        "args": {
            "commands": [
                "workbench.action.toggleMaximizedPanel",
                "workbench.action.toggleAuxiliaryBar",
                "workbench.action.toggleSidebarVisibility"
            ]
        }
    },

    // Workbench
    {
        "key": "{{ $mod }}+e",
        "command": "workbench.action.toggleMaximizedAuxiliaryBar"
    },
{{- if ne .chezmoi.os "darwin" }}
    {
        "key": "ctrl+w",
        "command": "workbench.action.closeActiveEditor",
        "when": "editorIsOpen"
    },
    {
        "key": "ctrl+w",
        "command": "workbench.action.closeWindow",
        "when": "!editorIsOpen"
    },
    {
        "key": "ctrl+w",
        "command": "workbench.action.terminal.kill",
        "when": "terminalFocus && (terminalHasBeenCreated || terminalIsOpen || terminalProcessSupported)"
    },
{{- end }}

    // Tab Navigation (Browser-style)
    {
        "key": "{{ $mod }}+1",
        "command": "workbench.action.openEditorAtIndex1"
    },
    {
        "key": "{{ $mod }}+2",
        "command": "workbench.action.openEditorAtIndex2"
    },
    {
        "key": "{{ $mod }}+3",
        "command": "workbench.action.openEditorAtIndex3"
    },
    {
        "key": "{{ $mod }}+4",
        "command": "workbench.action.openEditorAtIndex4"
    },

    // Editor Group Navigation
    {
        "key": "{{ $mod }}+shift+h",
        "command": "workbench.action.focusPreviousGroup"
    },
    {
        "key": "{{ $mod }}+shift+l",
        "command": "workbench.action.focusNextGroup"
    }
]
